[%- USE T8 %][%- USE HTML %][%- USE L %][%- USE LxERP %]

<form method="post" id="multi_items_form" method="POST">

<table id='multi_items_filter_table'>
  <tr>
    <th>[%- LxERP.t8("Description") %]/[%- LxERP.t8("Partnumber") %]:</th>
    <td>[%- L.input_tag('multi_items.filter.all:substr:multi::ilike', '') %]</td>
    <th>[%- LxERP.t8("Group") %]</th>
    <td>[%- L.select_tag('multi_items.filter.partsgroup_id', all_partsgroups, title_key='displayable_name', value_key='id', with_empty=1) %]</td>
  <tr>
</table>

[% L.button_tag('update_result()', LxERP.t8('Filter')) %]
<a href='#' onClick='javascript:$("#multi_items_filter_table input").val("");$("#multi_items_filter_table input[type=checkbox]").prop("checked", 0);$("#multi_items_filter_table select").prop("selectedIndex", 0);'>[% 'Reset' | $T8 %]</a>

<hr>
<div id='multi_items_result'></div>
<hr>

[% L.button_tag('add_multi_items()', LxERP.t8('Continue')) %]
<a href="#" onclick="close_multi_items_dialog();">[%- LxERP.t8("Cancel") %]</a>

<script type='text/javascript'>
function update_result() {
  var data = $('#multi_items_form').serialize();
  data += '&type=[%- FORM.type %]';
  $.ajax({
    url: 'controller.pl?action=Order/multi_items_update_result',
    data: data,
    success: function(data){
      $('#multi_items_result').html(data);
    }
  });
}

function add_multi_items() {
  var data = $('#[%- FORM.callback_data_id %]').serialize();
  data += '&';
  data += $('#multi_items_form').serialize();
  data += '&action=[%- FORM.callback %]';
  $.post("controller.pl", data, kivi.eval_json_result);
}
</script>

</form>
